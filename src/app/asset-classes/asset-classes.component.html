<div class="container py-4">
    <!-- Section Header Card with Add and Export Buttons -->
    <div class="card mb-4 shadow-sm">
      <div class="card-body d-flex justify-content-between align-items-center flex-wrap gap-2">
        <div>
          <h2 class="module-title mb-2">Asset Classes</h2>
          <p class="module-subtitle mb-0 text-muted">
            View and manage financial asset categories defined by risk, duration, and classification.
          </p>
        </div>
        <div class="d-flex flex-wrap gap-2">
          <button class="btn btn-outline-primary" (click)="exportToPDF()" aria-label="Export to PDF">
            Export to PDF
          </button>
          <button *ngIf="!showForm" class="btn btn-success" (click)="toggleForm()" aria-label="Add Asset Class">
            + Add Asset Class
          </button>
        </div>
      </div>
    </div>
  
    <!-- Create Form -->
    <div *ngIf="showForm" class="card mb-4 shadow-sm">
      <div class="card-body">
        <h5 class="card-title">Create Asset Class</h5>
  
        <form [formGroup]="createForm" (ngSubmit)="createAssetClass()">
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Asset ID</label>
              <input type="number" class="form-control" formControlName="id" placeholder="Enter unique ID" required autocomplete="off" />
              <div *ngIf="createForm.get('id')?.invalid && createForm.get('id')?.touched" class="text-danger small">
                Asset ID is required.
              </div>
            </div>
  
            <div class="col-md-6">
              <label class="form-label">Asset Class</label>
              <select class="form-select" formControlName="className" required>
                <option value="" disabled>Select Asset Class</option>
                <option *ngFor="let option of assetClassOptions" [value]="option">{{ option }}</option>
              </select>
              <div *ngIf="createForm.get('className')?.invalid && createForm.get('className')?.touched" class="text-danger small">
                Asset Class is required.
              </div>
            </div>
  
            <div class="col-md-6">
              <label class="form-label">Sub-Class Name</label>
              <input type="text" class="form-control" formControlName="subClassName" required />
              <div *ngIf="createForm.get('subClassName')?.invalid && createForm.get('subClassName')?.touched" class="text-danger small">
                Sub-Class Name is required.
              </div>
            </div>
  
            <div class="col-md-12">
              <label class="form-label">Description</label>
              <input type="text" class="form-control" formControlName="description" />
            </div>
  
            <div class="col-md-6">
              <label class="form-label">Risk Level</label>
              <select class="form-select" formControlName="risk" required>
                <option value="" disabled>Select Risk Level</option>
                <option value="Low">Low</option>
                <option value="Medium">Medium</option>
                <option value="High">High</option>
              </select>
              <div *ngIf="createForm.get('risk')?.invalid && createForm.get('risk')?.touched" class="text-danger small">
                Risk is required.
              </div>
            </div>
  
            <div class="col-md-6">
              <label class="form-label">Investment Horizon</label>
              <select class="form-select" formControlName="investmentHorizon">
                <option value="" disabled>Select Investment Horizon</option>
                <option value="Short Term">Short Term</option>
                <option value="Medium Term">Medium Term</option>
                <option value="Long Term">Long Term</option>
              </select>
            </div>
  
            <div class="col-md-12">
              <label class="form-label">Sub-Asset Description</label>
              <input type="text" class="form-control" formControlName="subAssetDescription" />
            </div>
          </div>
  
          <div class="mt-3 text-end">
            <button type="submit" class="btn btn-primary me-2" [disabled]="createForm.invalid">Create</button>
            <button type="button" class="btn btn-outline-secondary" (click)="toggleForm()">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  
    <!-- Loading Spinner -->
    <div *ngIf="loading" class="text-center py-5">
      <div class="spinner-border text-secondary"></div>
      <p class="mt-3 text-muted">Loading asset classes...</p>
    </div>
  
    <!-- Search and Sort Controls -->
    <div class="card mb-4 shadow-sm">
      <div class="card-body">
        <div class="row g-3 align-items-center">
          <div class="col-md-6">
            <input
              type="text"
              class="form-control"
              placeholder="Search asset classes..."
              [(ngModel)]="searchTerm"
              (ngModelChange)="applyFilters()" />
          </div>
  
          <div class="col-md-6">
            <div class="d-flex justify-content-end align-items-center flex-wrap gap-2">
              <label class="form-label mb-0">Sort By</label>
              <select
                class="form-select w-auto"
                [(ngModel)]="sortField"
                (change)="applyFilters()">
                <option value="">Select Field</option>
                <option value="className">Class Name</option>
                <option value="risk">Risk</option>
                <option value="investmentHorizon">Horizon</option>
              </select>
  
              <button class="sort-button" (click)="toggleSortDirection()" aria-label="Toggle Sort Direction">
                Sort: {{ sortDirection === 'asc' ? 'Ascending' : 'Descending' }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <!-- Table Display -->
    <div *ngIf="!loading && filteredAssetClasses.length > 0">
      <div class="table-responsive">
        <table class="table table-bordered table-striped table-hover align-middle shadow-sm">
          <thead class="table-header">
            <tr>
              <th scope="col">Asset ID</th>
              <th scope="col">Class Name</th>
              <th scope="col">Sub-Class</th>
              <th scope="col">Description</th>
              <th scope="col">Risk</th>
              <th scope="col">Horizon</th>
              <th scope="col">Sub-Asset Description</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let asset of filteredAssetClasses" class="hover-row position-relative">
              <td scope="row">{{ asset.id }}</td>
              <td>{{ asset.className }}</td>
              <td>{{ asset.subClassName }}</td>
              <td>{{ asset.description }}</td>
              <td>{{ asset.risk }}</td>
              <td>{{ asset.investmentHorizon }}</td>
              <td>{{ asset.subAssetDescription }}</td>
  
              <!-- Floating Action Box -->
              <div class="floating-actions d-none">
                <button class="btn btn-sm btn-outline-primary me-1" (click)="startEdit(asset)">Edit</button>
                <button *ngIf="asset.id !== null" (click)="deleteAsset(asset.id!)">Delete</button>
              </div>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  
    <!-- No Data Message -->
    <div *ngIf="!loading && filteredAssetClasses.length === 0" class="alert alert-warning mt-4">
      No asset classes available at the moment.
    </div>
  </div>
  